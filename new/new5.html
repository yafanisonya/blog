<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vuex 状态管理 | Fanison&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    
    <meta name="description" content="Keep Learning, Keep Growing, Keep Succeeding">
    
    <link rel="preload" href="/blog/assets/css/0.styles.dab10465.css" as="style"><link rel="preload" href="/blog/assets/js/app.e2933643.js" as="script"><link rel="preload" href="/blog/assets/js/2.54c8166e.js" as="script"><link rel="preload" href="/blog/assets/js/25.a06a7d8b.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.c30cb34c.js"><link rel="prefetch" href="/blog/assets/js/11.211070ff.js"><link rel="prefetch" href="/blog/assets/js/12.a4f7601d.js"><link rel="prefetch" href="/blog/assets/js/13.419ab80d.js"><link rel="prefetch" href="/blog/assets/js/14.f60212e1.js"><link rel="prefetch" href="/blog/assets/js/15.83ff36d3.js"><link rel="prefetch" href="/blog/assets/js/16.3cf65351.js"><link rel="prefetch" href="/blog/assets/js/17.5a5ed94c.js"><link rel="prefetch" href="/blog/assets/js/18.ee56c1a6.js"><link rel="prefetch" href="/blog/assets/js/19.9d9016bd.js"><link rel="prefetch" href="/blog/assets/js/20.ef230290.js"><link rel="prefetch" href="/blog/assets/js/21.d2d7eddc.js"><link rel="prefetch" href="/blog/assets/js/22.a2cdb77c.js"><link rel="prefetch" href="/blog/assets/js/23.f431a037.js"><link rel="prefetch" href="/blog/assets/js/24.f0d54556.js"><link rel="prefetch" href="/blog/assets/js/26.52cda476.js"><link rel="prefetch" href="/blog/assets/js/27.5e39016f.js"><link rel="prefetch" href="/blog/assets/js/28.ed132f17.js"><link rel="prefetch" href="/blog/assets/js/29.88de95fd.js"><link rel="prefetch" href="/blog/assets/js/3.415de851.js"><link rel="prefetch" href="/blog/assets/js/4.70c13cc5.js"><link rel="prefetch" href="/blog/assets/js/5.7418e283.js"><link rel="prefetch" href="/blog/assets/js/6.7b1f2309.js"><link rel="prefetch" href="/blog/assets/js/7.2de44a20.js"><link rel="prefetch" href="/blog/assets/js/8.c932c709.js"><link rel="prefetch" href="/blog/assets/js/9.debc90d0.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.dab10465.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Fanison's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/blog/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目总结" class="dropdown-title"><span class="title">项目总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目总结" class="mobile-dropdown-title"><span class="title">项目总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/project/" class="nav-link">
  Vue3 Wheel
</a></li><li class="dropdown-item"><!----> <a href="/blog/project/morney.html" class="nav-link">
  React Money
</a></li><li class="dropdown-item"><!----> <a href="https://yafanisonya.github.io/note/money/note.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue Money
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://yafanisonya.github.io/note/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  学习笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/yafanisonya" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/blog/frontend/" class="nav-link">
  前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目总结" class="dropdown-title"><span class="title">项目总结</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目总结" class="mobile-dropdown-title"><span class="title">项目总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/project/" class="nav-link">
  Vue3 Wheel
</a></li><li class="dropdown-item"><!----> <a href="/blog/project/morney.html" class="nav-link">
  React Money
</a></li><li class="dropdown-item"><!----> <a href="https://yafanisonya.github.io/note/money/note.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue Money
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://yafanisonya.github.io/note/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  学习笔记
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/yafanisonya" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Home</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/blog/cv/" class="sidebar-link">简历</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/frontend/" class="sidebar-link">手写代码</a></li><li><a href="/blog/frontend/fr002.html" class="sidebar-link">JS进阶</a></li><li><a href="/blog/frontend/fr003.html" class="sidebar-link">JS 基础</a></li><li><a href="/blog/frontend/fr004.html" class="sidebar-link">HTML、CSS、DOM</a></li><li><a href="/blog/frontend/typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/blog/frontend/webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/blog/frontend/browser.html" class="sidebar-link">浏览器</a></li><li><a href="/blog/frontend/network.html" class="sidebar-link">网络</a></li><li><a href="/blog/frontend/safety.html" class="sidebar-link">安全</a></li><li><a href="/blog/frontend/vue.html" class="sidebar-link">Vue</a></li><li><a href="/blog/frontend/react.html" class="sidebar-link">React</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>深入浅出</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/new/" aria-current="page" class="sidebar-link">小程序登录及封装</a></li><li><a href="/blog/new/new1.html" class="sidebar-link">服务端渲染</a></li><li><a href="/blog/new/new2.html" class="sidebar-link">函数式编程</a></li><li><a href="/blog/new/new3.html" class="sidebar-link">异步编程</a></li><li><a href="/blog/new/new4.html" class="sidebar-link">TypeScript</a></li><li><a href="/blog/new/new5.html" aria-current="page" class="active sidebar-link">Vuex 状态管理</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>项目总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/project/" class="sidebar-link">Vue3 Wheel</a></li><li><a href="/blog/project/morney.html" class="sidebar-link">React Money</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>知识点补充</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/question/" class="sidebar-link">Vue 补充</a></li><li><a href="/blog/question/js.html" class="sidebar-link">JS 补充</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="vuex-状态管理"><a href="#vuex-状态管理" class="header-anchor">#</a> Vuex 状态管理</h3> <h4 id="状态管理组成"><a href="#状态管理组成" class="header-anchor">#</a> 状态管理组成</h4> <ul><li>state： 驱动应用的数据源</li> <li>view： 以声明方式 将 state 映射到视图</li> <li>actions： 响应在 view 上的用户输入导致的状态变化</li></ul> <h4 id="组件通信方式"><a href="#组件通信方式" class="header-anchor">#</a> 组件通信方式</h4> <h5 id="父子传值-props"><a href="#父子传值-props" class="header-anchor">#</a> 父子传值： props</h5> <div class="language- extra-class"><pre class="language-text"><code>&lt;child title=&quot;value from parent&quot;&gt;&lt;/child&gt;

Vue.component('child',{
  props: ['title'],
  template: '&lt;p&gt; {{ title }} &lt;/p&gt;'
})
</code></pre></div><h5 id="子传父-emit"><a href="#子传父-emit" class="header-anchor">#</a> 子传父： $emit</h5> <div class="language- extra-class"><pre class="language-text"><code>// 子组件使用 $emit 发布自定义事件
&lt;button v-on:click=&quot;$emit('enlargeText', 0.1)&quot;&gt;Large Button&lt;/button&gt;

// 父组件
&lt;child v-on:enlargeText=&quot;fontsize += $event&quot;&gt;&lt;/child&gt;
</code></pre></div><h5 id="event-bus"><a href="#event-bus" class="header-anchor">#</a> Event Bus</h5> <div class="language- extra-class"><pre class="language-text"><code>// eventbus.js
export defalut new Vue()

import bus from './eventbus'
// 使用 $on 订阅
bus.$on('自定义事件', ()=&gt;{})

bus.$on('自定义事件', data =&gt; {})

// 使用 $emit 发布
bus.$emit('自定义事件')

bus.$emit('自定义事件', 数据)
</code></pre></div><h5 id="父通过-ref-获取子组件"><a href="#父通过-ref-获取子组件" class="header-anchor">#</a> 父通过 ref 获取子组件</h5> <div class="language- extra-class"><pre class="language-text"><code>// 父组件内容
&lt;child ref=&quot;c&quot;&gt;&lt;/child&gt;
this.$refs.c.value = 'value from ref'

// 子组件
&lt;input v-model=&quot;value&quot;&gt;

data(){
  return{
    value:''
  }
}
</code></pre></div><h4 id="vuex"><a href="#vuex" class="header-anchor">#</a> Vuex</h4> <ul><li>专门为 Vue.js 设计的状态管理库</li> <li>采用集中式的方式存储需要共享的数据</li> <li>从使用角度，就是一个 JS 库</li> <li>作用是进行状态管理，解决复杂组件通信，数据共享
应用场景：</li> <li>多个视图依赖于同一状态</li> <li>来自不同视图的行为需要变更同一状态</li></ul> <h5 id="基本结构"><a href="#基本结构" class="header-anchor">#</a> 基本结构</h5> <div class="language- extra-class"><pre class="language-text"><code>// 导入 Vuex
import Vuex from 'vuex'
Vue.use(vuex)

// 注册 Vuex
export default new Vuex.Store({
  state:{},
  getters:{},
  mutations:{},
  actions:{},
  modules:{}
})

// 注入 $store 到 Vue 实例
import store from './store'
new Vue({
  store,
  render: h =&gt; h(App)
}).$mount('#app')
</code></pre></div><h5 id="state"><a href="#state" class="header-anchor">#</a> State</h5> <p>Vuex 使用单一状态树，用一个对象就包含了全部的应用层级状态
使用 mapState 简化 State 在视图中的使用， mapState 返回计算属性</p> <div class="language- extra-class"><pre class="language-text"><code>// store
state: {
  count: 0,
  msg: 'Hello Vuex'
}

// vue中使用
// 1. 通过属性
this.$store.state.count

// 2. 通过辅助函数
import { mapState } from 'vuex'
// 方式一：接收数组参数
// mapState 返回名称为 count 和 msg 的计算属性
computed: {
  ...mapState(['count', 'msg'])
}

// 方式二：接收对象参数
// 通过传入对象，可以重命名返回的计算属性
computed: {
  ...mapState({ num: 'count',  message: 'msg '})
}

computed: {
  ...mapState({
    num: state =&gt; state.count,
    message: state =&gt; state.msg
  })
}
</code></pre></div><h5 id="getter"><a href="#getter" class="header-anchor">#</a> Getter</h5> <p>Getter 就是 store 中的计算属性， 使用 mapGetter 简化视图中的使用</p> <div class="language- extra-class"><pre class="language-text"><code>// store
state: {
  msg: 'Hello Vuex'
},
getters: {
  reverseMsg(state) {
    return state.msg.split('').reverse().join('')
  }
}

// vue中使用
// 1. 通过属性访问
this.$store.getters.reverseMsg

// 2. 通过辅助函数
import { mapGetters } from 'vuex'

export default {
  // ...
  computed: {
    ...mapGetters(['reverseMsg'])
    // 改名
    ...mapGetters({
      reverse: 'reverseMsg'
    })
  }
}
</code></pre></div><h5 id="mutation"><a href="#mutation" class="header-anchor">#</a> Mutation</h5> <ul><li>更改 Vuex 的 store 中的状态的唯一方法是 提交 mutation</li> <li>mutation 必须是同步函数</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// store
mutations: {
  increate(state, payload){
    state.count += payload
  }
}

// vue 中使用
// 1. 使用 commit
this.$store.commit('increate',2)

// 2. 通过辅助函数
import { mapMutations } from 'vuex'

export default {
  // ...
  methods: {
    ...mapMutations([
      'increate'
    ]),

    ...mapMutations({
      // 将 this.add() 映射为 this.$store.commit('increate',amount)
      add: 'increate'
    })
  }
}
</code></pre></div><h5 id="action"><a href="#action" class="header-anchor">#</a> Action</h5> <ul><li>Action 提交的是 mutation，而不是直接变更状态</li> <li>Action 可以包含任意异步操作</li> <li>通过 store.dispatch 方法触发</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// store
const store = new Vuex.Store({
  state: {
    count: 0
  },
  mutations: {
    increate(state, payload){
      state.count += payload
    }
  },
  actions: {
    // 接受一个与 store 实例具有相同方法和属性的 context 对象
    increateAsync(context, payload){
      setTimeout(()=&gt;{
        context.commit('increate', payload)
      },200)
    }
  }
})

// vue 中使用
// 1. 使用 dispatch
this.$store.dispatch('increateAsync', 5)

// 2. 通过辅助函数
import { mapActions } from 'vuex'
export default{
  // ...
  methods:{
    ...mapActions(['increateAsync']),

    ...mapActions({
      // 将 this.addAsync 映射为 this.$store.dispatch('increateAsync')
      addAsync: 'increateAsync'
    })
  }
}
</code></pre></div><h5 id="module"><a href="#module" class="header-anchor">#</a> Module</h5> <ul><li>将 store 分割成模块， 每个模块拥有自己的 state、 mutation、 action、 getter， 甚至嵌套子模块</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// moduleA
const state = {
  count: 2
}
const mutations = {
  addCount(state, payload){
    state.count += payload
  }
}

export default{
  // 命名空间
  namespaced: true,
  state,
  mutations
}

// store
const store = new Vuex.Store({
  modules: { moduleA }
})

// vue 中使用
import { mapState, mapMutations } from 'vuex'

export default{
  // ...
  computed: {
    ...mapState('moduleA', ['count'])
  },
  methods: {
    ...mapMutations('moduleA', ['addCount'])
  }
}
</code></pre></div><h5 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h5> <ul><li>Vuex 插件就是一个函数， 接收 store 作为唯一参数</li> <li>Store 接受 plugins 选项，这个选项暴露出每次 mutation 的钩子</li></ul> <div class="language- extra-class"><pre class="language-text"><code>const myPlugin = store =&gt; {
  store.subscribe((mutation, state) =&gt; {
    // 每次 mutation 之后调用
    // mutation 的格式 {type, payload}
  })
}

const store = new Vuex.Store({
  // ...
  plugins: [myPlugin]
})
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/new/new4.html" class="prev">
        TypeScript
      </a></span> <span class="next"><a href="/blog/project/">
        Vue3 Wheel
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e2933643.js" defer></script><script src="/blog/assets/js/2.54c8166e.js" defer></script><script src="/blog/assets/js/25.a06a7d8b.js" defer></script>
  </body>
</html>
